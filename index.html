<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js"
        integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT" crossorigin="anonymous">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-12 mt-5">
                <form class="needs-validation" novalidate>
                    <div class="form-row row">
                        <div class="col-md-6 mb-3">
                            <label for="surveyType">Survey Type</label>
                            <input type="text" class="form-control" id="surveyType" name="surveyType" value="Classic"
                                required>
                            <div class="valid-feedback">
                                Looks good!
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="description">Description</label>
                            <input type="text" class="form-control" id="description" name="description"
                                value="Test Anket" required>
                            <div class="valid-feedback">
                                Looks good!
                            </div>
                        </div>
                        <div class="form-row row">
                            <div class="col-md-4 mb-3">
                                <label for="title">Title</label>
                                <input type="text" class="form-control" id="title" name="title" value="Test Anket"
                                    required>
                                <div class="invalid-feedback">
                                    Please provide a Title.
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="logo">Logo</label>
                                <input type="text" class="form-control" id="logo" name="logo" value="https://logo.jpg"
                                    required>
                                <div class="invalid-feedback">
                                    Please provide a Logo.
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="logoPosition">logo Position</label>
                                <input type="text" class="form-control" id="logoPosition" name="logoPosition"
                                    value="left" required>
                                <div class="invalid-feedback">
                                    Please provide a Logo Position.
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="pagePrevText">Page Prev Text</label>
                                <input type="text" class="form-control" id="pagePrevText" name="pagePrevText" value="">
                                <div class="invalid-feedback">
                                    Please provide a Page Prev Text.
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="pageNextText">Page Next Text</label>
                                <input type="text" class="form-control" id="pageNextText" name="pageNextText" value="">
                                <div class="invalid-feedback">
                                    Please provide a Page Next Text.
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="completeText">Complete Text</label>
                                <input type="text" class="form-control" id="completeText" name="completeText"
                                    value="Tamamla" required>
                                <div class="invalid-feedback">
                                    Please provide a Complete Text.
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="startSurveyText">Start Survey Text</label>
                                <input type="text" class="form-control" id="startSurveyText" name="startSurveyText"
                                    value="Başla" required>
                                <div class="invalid-feedback">
                                    Please provide a Start Survey Text.
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="completingSurvey">Completing Survey</label>
                                <input type="text" class="form-control" id="completingSurvey" name="completingSurvey"
                                    value="Anket'e katıldığınız için teşekkür ederiz!" required>
                                <div class="invalid-feedback">
                                    Please provide a Completing Survey.
                                </div>
                            </div>
                            <br><br><br>
                            <hr>

                            <h3>Questions</h3>

                            <div class="container">
                                <input type="button" class="btn btn-primary mb-4" data-toggle="collapse"
                                    data-target="#questionContainer" value="Questions"></input>
                                <input type="button" id="btn_add" class="btn btn-primary mb-4" value=" + "
                                    onclick="QuestionAdd()">

                                <div id="questionContainer" class="collapse">
                                    <div id="questionSample" style="display: none;">
                                        <div class="form-row row">
                                            <div class="col-md-4 mb-3">
                                                <label>Type</label>
                                                <input type="text" class="form-control Q_Type" value="RadioGroup"
                                                    required>
                                            </div>
                                            <div class="col-md-4 mb-3">
                                                <label>Name</label>
                                                <input type="text" class="form-control Q_Name" value="" required>
                                            </div>
                                            <div class="col-md-4 mb-3">
                                                <label>Title</label>
                                                <input type="text" class="form-control Q_Title"
                                                    value="Verdiğimiz hizmetten memnun kaldınız mı?" required>
                                            </div>
                                            <div class="col-md-4 mb-3">
                                                <label>isRequired</label>
                                                <input type="text" class="form-control Q_isRequired" value=false
                                                    required>
                                            </div>
                                            <div class="col-md-4 mb-3">
                                                <label>Order</label>
                                                <input type="text" class="form-control Q_Order" value=1 required>
                                            </div>


                                            <div class="container">
                                                <h4 class="d-inline "> <span class="label label-primary">Choices</span>
                                                </h4>
                                                <input type="button" data-id=""
                                                    class="btn btn-secondary mb-2 btn-sm Q_Choices_Button" value=" + "
                                                    onclick="ChoicesAdd(this)">
                                            </div>
                                            <div class="choicesContainer">
                                                <div id="choicesSample" style="display: none;">
                                                    <div class="form-row row">
                                                        <div class="col-md-4 mb-3">
                                                            <label>Choice Value</label>
                                                            <input type="text" class="form-control Q_ChoiceValue"
                                                                placeholder="Örn: A)" required>
                                                        </div>

                                                        <div class="col-md-4 mb-3">
                                                            <label>Choice Text</label>
                                                            <input type="text" class="form-control Q_ChoiceText"
                                                                placeholder="Örn: Çok iyi" required>
                                                        </div>
                                                        <div class="col-md-4 mb-3">
                                                            <label>Choice Order</label>
                                                            <input type="text" class="form-control Q_ChoiceOrder"
                                                                placeholder=1 required>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-primary mt-2 col-4 mx-auto" id="submit" type="submit"
                            onclick="Submit()">Submit form</button>
                    </div>
                </form>
                <br>
                <br>
            </div>
        </div>
    </div>


    <script>
        var i = 0;

        var questionSample = $("#questionSample").html();

        function QuestionAdd() {

            var tempQuestionSample = questionSample;

            let questionSampleDiv = $('<div>', {
                "id": "questionSample" + i,
                "class": "questionSample"
            });

            let questionNumber = $('<h4>', {
                "text": "Question " + (i + 1),
            });

            let hrLine = $('<hr>', {
                "style": "width:50%",
                "class": "mx-auto border border-primary"
            });

            $("#questionContainer").append(

                questionSampleDiv.append(

                    questionNumber,
                    $(tempQuestionSample).show(),
                    hrLine,

                ),
            );

            $(questionSampleDiv).find(".Q_Type").attr("id", "Q_Type" + i);
            $(questionSampleDiv).find(".Q_Name").attr("id", "Q_Name" + i);
            $(questionSampleDiv).find(".Q_Title").attr("id", "Q_Title" + i);
            $(questionSampleDiv).find(".Q_isRequired").attr("id", "Q_isRequired" + i);
            $(questionSampleDiv).find(".Q_Order").attr("id", "Q_Order" + i);

            $(questionSampleDiv).find(".Q_Choices_Button").attr("data-id", i + 1);

            i++;

        }

        var j = 0;

        var choicesSample = $("#choicesSample").html();

        function ChoicesAdd(element) {

            var tempChoicesSample = choicesSample;

            let choicesSampleDiv = $('<div>', {
                "id": "choicesSample" + j,
                "class": "choicesSample",
            });

            var dataId = $(element).attr("data-id");

            $($(".choicesContainer")[dataId]).append(

                choicesSampleDiv.append(

                    $(tempChoicesSample).show()

                ),
            );

            $(choicesSampleDiv).find(".Q_ChoiceValue").attr("id", "Q_ChoiceValue" + j);
            $(choicesSampleDiv).find(".Q_ChoiceText").attr("id", "Q_ChoiceText" + j);
            $(choicesSampleDiv).find(".Q_ChoiceOrder").attr("id", "Q_ChoiceOrder" + j);

            j++;
        }
    </script>

    <script>
        function Submit() {
            var surveyType = $("#surveyType").val();
            var description = $("#description").val();
            var title = $("#title").val();
            var logo = $("#logo").val();
            var logoPosition = $("#logoPosition").val();
            var pagePrevText = $("#pagePrevText").val();
            var pageNextText = $("#pageNextText").val();
            var completeText = $("#completeText").val();
            var startSurveyText = $("#startSurveyText").val();
            var completingSurvey = $("#completingSurvey").val();

            let questionSamples = $('.questionSample');

            var questions_data = Array();

            for (i = 0; i < questionSamples.length; i++) {

                let questionSample = questionSamples[i];
                let question_data = {
                    "type": $(questionSample).find('.Q_Type').val(),
                    "name": $(questionSample).find('.Q_Name').val(),
                    "title": $(questionSample).find('.Q_Q_Title').val(),
                    "isRequired": $(questionSample).find('.Q_isRequired').val(),
                    "order": $(questionSample).find('.Q_Order').val(),

                    "choices": Array()
                }
                let choicesContainer = $(questionSamples).find('.choicesSample');

                for (let y = 0; y < choicesContainer.length; y++) {
                    let choice_data = choicesContainer[y];

                    question_data.choices = {
                        "choicesValue": $(choice_data).find('.Q_ChoiceValue').val(),
                        "choicesText": $(choice_data).find('.Q_ChoiceText').val(),
                        "choicesOrder": $(choice_data).find('.Q_ChoiceOrder').val(),
                    }
                }
                questions_data.push(question_data)

            }

            let toSent = {

                "surveyType": surveyType,
                "description": description,
                "title": title,
                "logo": logo,
                "logoPosition": logoPosition,
                "pagePrevText": pagePrevText,
                "pageNextText": pageNextText,
                "completeText": completeText,
                "startSurveyText": startSurveyText,
                "completingSurvey": completingSurvey,

                "questions": questions_data,
                
            }

            $(function () {
                $("#submit").click(function () {
                    $.ajax({
                        url: "http://6ie80a5qg5.execute-api.eu-north-1.amazonaws.com/Development/api/v1/surveys?appname=MsApplication",
                        type: "POST",
                        headers: {"x-api-key":"oiiCvAdaoY61mjwxqGFxF9TDpiGrakJ47sAC4WcZ"},
                        data: toSent
                    })
                });
            });

        


        /*
                    var ajaxResult = $.ajax({
                        url: "http://6ie80a5qg5.execute-api.eu-north-1.amazonaws.com/Development/api/v1/surveys?appname=MsApplication",
                        type: "POST",
                        datatype:"json",
                        data: toSent,
                        headers: {
                            "Content-Type": "application/json",
                            "x-api-key": "oiiCvAdaoY61mjwxqGFxF9TDpiGrakJ47sAC4WcZ"
                        },
                    })
                    ajaxResult.done(function (response, textStatus, jqXHR){
                        
                        console.log(response);
                    });
                    
                    var ajaxResult = $.ajax({
                        url: "http://test-api.profasorapp.com:8080/api/healthcheck",
                        type: "GET",
                        headers: {"x-api-key":"oiiCvAdaoY61mjwxqGFxF9TDpiGrakJ47sAC4WcZ"},
                        data: toSent
                    })
                    ajaxResult.done(function (response, textStatus, jqXHR){
                        
                        console.log(response);
                    });
        */


        }
    </script>














    <script>
        (function () {
            'use strict';
            window.addEventListener('load', function () {

                var forms = document.getElementsByClassName('needs-validation');

                var validation = Array.prototype.filter.call(forms, function (form) {
                    form.addEventListener('submit', function (event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);
        })();
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
</body>

</html>